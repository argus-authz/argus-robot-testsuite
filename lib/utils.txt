** Settings ***

Library   OperatingSystem
Resource   variables.txt

*** Keywords ***

Execute and Check Success  [Arguments]  ${cmd}
  ${rc}  ${output}=  Run and Return RC And Output  ${cmd}
  Should Be Equal As Integers  ${rc}  0  ${cmd} failed with ${output}  False
  [Return]  ${output}  ${EMPTY}

Execute and Check Failure  [Arguments]   ${cmd}
  ${rc}  ${output}=   Run and Return RC And Output  ${cmd}
  Should Not Be Equal As Integers  ${rc}  0  ${cmd} failed with ${output}
  [Return]  ${output}

Create policyfile  [Arguments]  ${policies}
  Create File  ${POLICY_FILE}  ${policies}

Load policyfile
  ${rc}=  Run And Return Rc  pap-admin apf ${POLICY_FILE}
  [Return]  ${rc}

Remove policyfile
  Remove File  ${POLICY_FILE}
  
Clean policy repository
  Execute And Check Success  pap-admin rap

Clean up
  Clean policy repository
  Remove policyfile

Prepare environment  [Arguments]  ${policies}
  Create policyfile  ${policies}
  Clean policy repository
  ${rc}=  Load policyfile
  Should Be Equal As Integers  ${rc}  0