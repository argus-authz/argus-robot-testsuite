*** Settings ***
Resource   lib/utils.txt

Suite Setup     Make backup of the configuration
Suite Teardown  Restore configurations

*** Test Cases ***
PDP status
  Start PDP service
  ${cmd}=  Set Variable  ${T_PDP_CTRL} status | grep -q "Status: OK"
  Execute and Check Success  ${cmd}
  
Error exit codes (bug 65542)
  Stop PDP service
  Execute and Check Failure  ${T_PDP_CTRL} status

XACML SOAP handler error (bug 75860)
  Start PDP service
  ${cmd}=  Set Variable  echo "POST /authz" | openssl s_client -connect `hostname`:8152 -quiet
  ${output}=  Execute and Check Success  ${cmd}
  Should Contain  ${output}  soap11:Fault

The proposed file-structure for is given (bug 77532)
  ${file}=  Set Variable  /usr/sbin/pdpctl
  Check file  ${file}
  ${dir}=  Set Variable  /etc/argus/pdp
  Check directory  ${dir}
  
Check PID file (bug 80510)
  ${file}=  Set Variable  /var/run/argus-pdp.pid
  Start PDP service
  Check File  ${file}
  
#Memory limit (bug 84844)
#  Start PDP service
#  ${output}=  Execute and Check Success  ps ax | grep PDPDaemon
#  Should Contain  ${output}  -Xmx256
  
#Use correct VOMS Java API (bug 84848)
#  @{list}=  Create List  bcprov.jar  trustmanager.jar  vomsjapi.jar  argus-pdp-pep-common.jar
#  :FOR  ${elem}  IN  @{list}
#  \  ${jar}=  Join Path  ${T_PDP_HOME}/lib  ${elem}
#  \  Should Exist  ${jar}